by = c(grouping_factors, "row_in_group")
) %>%
# Select only the relevant columns
select(names(df), x = x_values)
View(df)
View(collapsed_df)
df <- collapsed_df
result_df <- df %>%
# Group by the grouping factors
group_by(across(all_of(grouping_factors))) %>%
# Create the interpolated x values for each group
mutate(
x_values = pmap(list(group_min_x, group_max_x, across(all_of(grouping_factors))),
function(min_x, max_x, ...) {
# Filter the original dataframe based on the current group
group_df <- df %>%
filter(across(all_of(grouping_factors),
~ . == c(...)))
# Create linear sequence from min to max
seq(min_x, max_x, length.out = nrow(group_df))
})
) %>%
# Unnest the x_values
unnest(x_values) %>%
# Join back to the original dataframe
left_join(
df %>%
group_by(across(all_of(grouping_factors))) %>%
mutate(row_in_group = row_number()),
by = c(grouping_factors, "row_in_group")
) %>%
# Select only the relevant columns
select(names(df), x = x_values)
rlang::last_trace()
grouping_factors
result_df <- df %>%
# Group by the grouping factors
group_by(across(all_of(grouping_factors)))
View(result_df)
result_df <- df %>%
# Group by the grouping factors
group_by(across(all_of(grouping_factors))) %>%
# Create the interpolated x values for each group
mutate(
x_values = pmap(list(group_min_x, group_max_x, across(all_of(grouping_factors))),
function(min_x, max_x, ...) {
# Filter the original dataframe based on the current group
group_df <- df %>%
filter(across(all_of(grouping_factors),
~ . == c(...)))
# Create linear sequence from min to max
seq(min_x, max_x, length.out = nrow(group_df))
})
)
result_df <- df %>%
# Group by the grouping factors
group_by(across(all_of(grouping_factors))) %>%
# Create the interpolated x values for each group
mutate(
x_values = pmap(list(group_min_x, group_max_x, across(all_of(grouping_factors))),
function(min_x, max_x, ...) {
# Filter the original dataframe based on the current group
group_df <- df %>%
filter(across(all_of(grouping_factors),
~ . == c(...)))
# Create linear sequence from min to max
seq(min_x, max_x, length.out = nrow(group_df))
})
)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/compute_scatter_x_values.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/compute_scatter_x_values.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/compute_scatter_x_values.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_for_diff_bars.R")
unique_combinations <- df %>%
select(all_of(grouping_factors)) %>%
distinct()
seq_along(unique_combinations)
compute_scatter_x_values(df, grouping_factors)
i
current_combination
View(current_df)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/compute_scatter_x_values.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/compute_scatter_x_values.R")
compute_scatter_x_values(df, grouping_factors)
min_x
max_x
x_values
View(df)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/compute_scatter_x_values.R")
View(collapsed_df)
collapsed_df$x <- compute_scatter_x_values(collapsed_df, grouping_factors)
collapsed_df <- compute_scatter_x_values(collapsed_df, grouping_factors)
View(collapsed_df)
a <- <- compute_scatter_x_values(collapsed_df, grouping_factors)
a <- compute_scatter_x_values(collapsed_df, grouping_factors)
View(a)
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/compute_scatter_x_values.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/my_scatter_plot.R")
source("Y:/LabMembers/MTillman/R_Project_Agnostic_Code/my_bar.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_for_diff_bars.R")
collapsed_df <- compute_scatter_x_values(collapsed_df, grouping_factors)
View(collapsed_df)
############################
## CONFIG
############################
# Read the config file
config_path <- "Y:\\LabMembers\\MTillman\\GitRepos\\Stroke-R01\\RCode\\config.toml"
config <- configr::read.config(file = config_path)
# Set the working directory and source the helper functions
setwd(config$paths$wd)
files <- list.files(config$paths$helper_functions, pattern = "\\.R$", full.names = TRUE)
sapply(files, source)
# TESTING ONLY
files <- list.files("Y:\\LabMembers\\MTillman\\GitRepos\\Stroke-R01\\RCode\\plotter", pattern = "\\.R$", full.names = TRUE)
sapply(files, source)
# Create the folder to store the results of this analysis
analysis_name <- config$analysis_name
analysis_output_folder = file.path(config$paths$root_save, analysis_name)
if (!dir.exists(analysis_output_folder)) {
dir.create(analysis_output_folder)
}
# Initialize variables
# Factors
plot_grouping_factors <- config$plots$grouping_factors
fill_factor <- config$plots$fill_factor
factors_in_model <- config$stats$factors_in_model
all_factors_col_names <- config$all_factor_columns
# Levels in each factor
factors_levels_order <- config$factors_levels_order
factors_levels_to_remove <- config$factors_levels_to_remove
# Paths
data_file_path <- config$paths$data_file
colors<- config$plots$colors
# Linear mixed model & estimated marginal means formulae
lmer_formula <- config$stats$lmer_formula
emmeans_formula <- config$stats$emmeans_formula
#############################
## READ IN DATA
#############################
# Read the CSV file
all_data <- read_data(data_file_path, all_factors_col_names) # From fcns.R
# Order the levels of each factor for which the levels order was specified
factors_with_specified_levels_order <- names(factors_levels_order)
for (factor_name in factors_with_specified_levels_order) {
all_data[[factor_name]] <- factor(all_data[[factor_name]], levels = factors_levels_order[[factor_name]])
}
# Remove any levels of any factors that we don't want to analyze
factors_with_levels_to_remove <- names(factors_levels_to_remove)
for (factor_name in factors_with_levels_to_remove) {
all_data <- remove_levels(all_data, factor_name, factors_levels_to_remove[[factor_name]])
}
# Get the column names of interest from the data table
outcome_measures_cols <- names(all_data)[sapply(all_data, function(x) !is.factor(x))]
col_name = outcome_measures_cols[1]
emmeans_list <- list()
comps_list <- list()
curr_data <- curr_col_data(all_data, col_name, all_factors_col_names)
lmer_model <- make_model(curr_data, lmer_formula, col_name)
# Get the marginal means
emmeans <- get_emmeans(lmer_model, emmeans_formula, col_name)
emmeans_list[[col_name]] <- emmeans
# Hypothesis tests
comps <- hyp_tests(lmer_model, curr_data, emmeans, col_name)
comps_list[[col_name]] <- comps
# Plot the data in a way that will work with significant difference bars
collapsed_df <- collapse_data(curr_data, c())
plot_result <- plot_for_diff_bars(collapsed_df, plot_grouping_factors, col_name, plot_type = "scatter", fill_factor=fill_factor)
plotted_df <- plot_result$df
gp_no_sig_diff_bars <- plot_result$gp
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
diff_bars_factors
contrast_factor_list
plotted_df_names
plotted_df
View(plotted_df)
plot_grouping_factors
gp_no_sig_diff_bars
plotted_df
comps
col_name
vert_bar_height
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
plotted_df
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
plotted_df_names
plotted_df
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
force(comps)
grouping_factors
grouping_factors
plotted_df
plotted_df_names
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
contrasts_split
x_range
horz_offset_in_units
View(comps_bars_df)
View(sig_diff_bars_y_df)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
View(sig_diff_bars_x_df)
View(sig_diff_bars_x_df)
View(sig_diff_bars_x_df)
View(sig_diff_bars_x_df)
View(sig_diff_bars_y_df)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
View(sig_diff_bars_x_df)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
sig_diff_bars_x_df <- sig_diff_bars_x_df %>% filter(p < p_cutoff)
View(sig_diff_bars_y_df)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
View(sig_diff_bars_y_df)
diff_bar_vert_y
diff_bar_vert_y = sig_diff_bars_xy_df$y_positions-vert_bar_height*diff(y_range)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
diff_bar_vert_y
print(gp)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.05,
bar_offsets=c(0.05, 0.1), min_y_distance=0.05, text_size=2,
show_p_values = TRUE,
horz_offset = 0.008)
gp_sig_diff_bars <- result$plot
sig_diff_bars_df <- result$sig_diff_bars_df
print(gp_sig_diff_bars)
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
############################
## CONFIG
############################
# Read the config file
config_path <- "Y:\\LabMembers\\MTillman\\GitRepos\\Stroke-R01\\RCode\\config.toml"
config <- configr::read.config(file = config_path)
# Set the working directory and source the helper functions
setwd(config$paths$wd)
files <- list.files(config$paths$helper_functions, pattern = "\\.R$", full.names = TRUE)
sapply(files, source)
# TESTING ONLY
files <- list.files("Y:\\LabMembers\\MTillman\\GitRepos\\Stroke-R01\\RCode\\plotter", pattern = "\\.R$", full.names = TRUE)
sapply(files, source)
# Create the folder to store the results of this analysis
analysis_name <- config$analysis_name
analysis_output_folder = file.path(config$paths$root_save, analysis_name)
if (!dir.exists(analysis_output_folder)) {
dir.create(analysis_output_folder)
}
# Initialize variables
# Factors
plot_grouping_factors <- config$plots$grouping_factors
fill_factor <- config$plots$fill_factor
factors_in_model <- config$stats$factors_in_model
all_factors_col_names <- config$all_factor_columns
# Levels in each factor
factors_levels_order <- config$factors_levels_order
factors_levels_to_remove <- config$factors_levels_to_remove
# Paths
data_file_path <- config$paths$data_file
colors<- config$plots$colors
# Linear mixed model & estimated marginal means formulae
lmer_formula <- config$stats$lmer_formula
emmeans_formula <- config$stats$emmeans_formula
#############################
## READ IN DATA
#############################
# Read the CSV file
all_data <- read_data(data_file_path, all_factors_col_names) # From fcns.R
# Order the levels of each factor for which the levels order was specified
factors_with_specified_levels_order <- names(factors_levels_order)
for (factor_name in factors_with_specified_levels_order) {
all_data[[factor_name]] <- factor(all_data[[factor_name]], levels = factors_levels_order[[factor_name]])
}
# Remove any levels of any factors that we don't want to analyze
factors_with_levels_to_remove <- names(factors_levels_to_remove)
for (factor_name in factors_with_levels_to_remove) {
all_data <- remove_levels(all_data, factor_name, factors_levels_to_remove[[factor_name]])
}
# Get the column names of interest from the data table
outcome_measures_cols <- names(all_data)[sapply(all_data, function(x) !is.factor(x))]
col_name = outcome_measures_cols[1]
emmeans_list <- list()
comps_list <- list()
curr_data <- curr_col_data(all_data, col_name, all_factors_col_names)
# Create the lmer model
lmer_model <- make_model(curr_data, lmer_formula, col_name)
# Get the marginal means
emmeans <- get_emmeans(lmer_model, emmeans_formula, col_name)
emmeans_list[[col_name]] <- emmeans
# Hypothesis tests
comps <- hyp_tests(lmer_model, curr_data, emmeans, col_name)
comps_list[[col_name]] <- comps
# Plot the data in a way that will work with significant difference bars
collapsed_df <- collapse_data(curr_data, c())
plot_result <- plot_for_diff_bars(collapsed_df, plot_grouping_factors, col_name, plot_type = "scatter", fill_factor=fill_factor)
plotted_df <- plot_result$df
gp_no_sig_diff_bars <- plot_result$gp
print(gp_no_sig_diff_bars)
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
line_plot_from_lmer(curr_data, col_name, lmer_model)
bar_plot_from_lmer(curr_data, col_name, lmer_model, comps)
interaction_plot_from_lmer(curr_data, col_name, lmer_model, comps, x_axis_factor = grouping_factors[1], color_factor = grouping_factors[2], facet_factors = NULL)
interaction_plot_from_lmer(curr_data, col_name, lmer_model, comps, x_axis_factor = plot_grouping_factors[1], color_factor = plot_grouping_factors[2], facet_factors = NULL)
summarize_model(lmer_model)
plot_all_histograms(curr_data, plot_grouping_factors, col_name, fill_factor = fill_factor)
View(plotted_df)
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
contrast
plotted_df_removed
plotted_df_lists
plotted_list
View(plotted_list)
left_index
right_index
left_index
contrast$left[[factor]]
contrast$right[[factor]]
plotted_df$group_mean_x[[left_index]]
plotted_df$group_mean_x[[right_index]]
View(plotted_list)
contrast$right
contrast$left
contrast$left[[factor]]
contrast$right[[factor]]
plotted_df$group_mean_x[[left_index]]
left_index
plotted_df$group_mean_x[[right_index]]
right_index
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
View(plotted_df)
View(comps_df)
View(bars_xy)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
View(bars_xy)
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/sig_diff_bars_x_data_and_colors.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.02, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
print(gp_no_sig_diff_bars)
print(gp_sig_diff_bars)
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.05, text_offset=0.005, min_y_distance=0.05, text_size=2,
show_p_values = TRUE, horz_offset = 0.008)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.03, text_offset=0.005, min_y_distance=0.02, text_size=2,
show_p_values = TRUE, horz_offset = 0.008, step_increase=0.06)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
line_plot_from_lmer(curr_data, col_name, lmer_model)
outcome_measures_cols
col_name = outcome_measures_cols[109]
curr_data <- curr_col_data(all_data, col_name, all_factors_col_names)
# Create the lmer model
lmer_model <- make_model(curr_data, lmer_formula, col_name)
# Get the marginal means
emmeans <- get_emmeans(lmer_model, emmeans_formula, col_name)
emmeans_list[[col_name]] <- emmeans
# Hypothesis tests
comps <- hyp_tests(lmer_model, curr_data, emmeans, col_name)
comps_list[[col_name]] <- comps
# Plot the data in a way that will work with significant difference bars
collapsed_df <- collapse_data(curr_data, c())
plot_result <- plot_for_diff_bars(collapsed_df, plot_grouping_factors, col_name, plot_type = "scatter", fill_factor=fill_factor)
plotted_df <- plot_result$df
gp_no_sig_diff_bars <- plot_result$gp
# Add the significant difference bars
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.03, text_offset=0.005, min_y_distance=0.02, text_size=2,
show_p_values = TRUE, horz_offset = 0.008, step_increase=0.06)
gp_sig_diff_bars <- result$plot
print(gp_sig_diff_bars)
sig_diff_bars_df <- result$sig_diff_bars_df
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
debugSource("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
result <- plot_sig_diff_bars(gp_no_sig_diff_bars, plotted_df, comps, plot_grouping_factors,
col_name, vert_bar_height=0.03, text_offset=0.005, min_y_distance=0.02, text_size=2,
show_p_values = TRUE, horz_offset = 0.008, step_increase=0.06)
View(built_plot)
built_plot$data[[1]]
built_plot$data[[1]]$fill
packageVersion("ggplot2")
View(plot_sig_diff_bars)
source("Y:/LabMembers/MTillman/GitRepos/Stroke-R01/RCode/plotter/plot_sig_diff_bars.R")
